{
  "id": "hytale",
  "name": "Hytale",
  "description": "Set out on an adventure built for both creation and play. Hytale blends the freedom of a sandbox with the momentum of an RPG: explore a procedurally generated world full of dungeons, secrets, and a variety of creatures, then shape it block by block.",
  "author": "Catalyst Maintainers",
  "version": "1.0.0",
  "image": "ghcr.io/pterodactyl/games:hytale",
  "images": [
    {
      "name": "hytale",
      "label": "Hytale (Official)",
      "image": "ghcr.io/pterodactyl/games:hytale"
    }
  ],
  "defaultImage": "ghcr.io/pterodactyl/games:hytale",
  "installImage": "alpine:3.19",
  "startup": "java $( (({{USE_AOT_CACHE}})) && printf %s \"-XX:AOTCache=Server/HytaleServer.aot\" ) -Xms128M $( (({{SERVER_MEMORY}})) && printf %s \"-Xmx{{SERVER_MEMORY}}M\" ) -XX:MaxMetaspaceSize=512M -XX:+UnlockExperimentalVMOptions -XX:+UseShenandoahGC -XX:ShenandoahGCHeuristics=compact -XX:ShenandoahUncommitDelay=30000 -XX:ShenandoahAllocationThreshold=15 -XX:ShenandoahGuaranteedGCInterval=30000 -XX:+PerfDisableSharedMem -XX:+DisableExplicitGC -XX:+ParallelRefProcEnabled -XX:ParallelGCThreads=4 -XX:ConcGCThreads=2 -jar Server/HytaleServer.jar $( (({{HYTALE_ALLOW_OP}})) && printf %s \"--allow-op\" ) $( (({{HYTALE_ACCEPT_EARLY_PLUGINS}})) && printf %s \"--accept-early-plugins\" ) $( (({{DISABLE_SENTRY}})) && printf %s \"--disable-sentry\" ) --auth-mode {{HYTALE_AUTH_MODE}} --assets Assets.zip --bind 0.0.0.0:{{SERVER_PORT}}",
  "stopCommand": "stop",
  "sendSignalTo": "SIGTERM",
  "variables": [
    {
      "name": "SERVER_PORT",
      "description": "Server port",
      "default": "40000",
      "required": true,
      "input": "number",
      "rules": [
        "between:1024,65535"
      ]
    },
    {
      "name": "SERVER_MEMORY",
      "description": "Maximum memory in MB for the JVM (-Xmx). Leave empty to use container limit.",
      "default": "",
      "required": false,
      "input": "number"
    },
    {
      "name": "HYTALE_AUTH_MODE",
      "description": "Authentication mode",
      "default": "authenticated",
      "required": true,
      "input": "select",
      "rules": [
        "in:authenticated,offline"
      ]
    },
    {
      "name": "HYTALE_PATCHLINE",
      "description": "The branch of Hytale to install",
      "default": "release",
      "required": true,
      "input": "select",
      "rules": [
        "in:release,pre-release"
      ]
    },
    {
      "name": "HYTALE_ACCEPT_EARLY_PLUGINS",
      "description": "Allow loading early plugins (unsupported, may cause stability issues)",
      "default": "0",
      "required": false,
      "input": "checkbox"
    },
    {
      "name": "HYTALE_ALLOW_OP",
      "description": "Allow operators",
      "default": "0",
      "required": false,
      "input": "checkbox"
    },
    {
      "name": "USE_AOT_CACHE",
      "description": "Use Ahead-of-Time Java cache to improve boot times",
      "default": "1",
      "required": false,
      "input": "checkbox"
    },
    {
      "name": "DISABLE_SENTRY",
      "description": "Disable Sentry crash tracking (recommended during plugin development)",
      "default": "0",
      "required": false,
      "input": "checkbox"
    },
    {
      "name": "INSTALL_SOURCEQUERY_PLUGIN",
      "description": "Install the Source Query plugin for A2S requests (player count, server name, etc.)",
      "default": "1",
      "required": false,
      "input": "checkbox"
    },
    {
      "name": "QUERY_PORT",
      "description": "Port for Source Query plugin A2S responses. Defaults to game port + 1 if empty.",
      "default": "",
      "required": false,
      "input": "number",
      "rules": [
        "between:1,65535"
      ]
    }
  ],
  "installScript": "#!/bin/bash\nset -e\n\nmkdir -p {{SERVER_DIR}}\ncd {{SERVER_DIR}}\n\nDOWNLOAD_URL=\"https://downloader.hytale.com/hytale-downloader.zip\"\n\necho '[Catalyst] Downloading Hytale Downloader CLI...'\n\nrm -f hytale-downloader.zip\ncurl -sL -o hytale-downloader.zip \"$DOWNLOAD_URL\"\nunzip -o -DD hytale-downloader.zip -d hytale-downloader\nmv hytale-downloader/hytale-downloader-linux-amd64 hytale-downloader/hytale-downloader-linux 2>/dev/null || true\nchmod 555 hytale-downloader/hytale-downloader-linux\n\necho \"[Catalyst] Hytale Downloader version: $(./hytale-downloader/hytale-downloader-linux -version)\"\n\necho '[Catalyst] Running Hytale Downloader to download server files...'\nDOWNLOAD_ZIP=\"{{SERVER_DIR}}/hytale-server.zip\"\n./hytale-downloader/hytale-downloader-linux -patchline {{HYTALE_PATCHLINE}} -download-path \"$DOWNLOAD_ZIP\" -credentials-path {{SERVER_DIR}}/.hytale-downloader-credentials.json\n\nif [ ! -f \"$DOWNLOAD_ZIP\" ]; then\n  echo '[Catalyst] ERROR: Download failed - server zip not found'\n  exit 1\nfi\n\necho '[Catalyst] Extracting server files...'\nunzip -o \"$DOWNLOAD_ZIP\" -d {{SERVER_DIR}}\nrm -f \"$DOWNLOAD_ZIP\"\n\necho '[Catalyst] Fixing file ownership for runtime user...'\nchown -R 1001:1001 {{SERVER_DIR}}\nchmod -R u+rwX {{SERVER_DIR}}\n\necho '[Catalyst] Hytale installation complete!'",
  "supportedPorts": [
    40000
  ],
  "allocatedMemoryMb": 2048,
  "allocatedCpuCores": 2,
  "features": {
    "modManager": {
      "targets": [
        "mods"
      ],
      "providers": [
        {
          "id": "curseforge",
          "label": "CurseForge (Hytale)",
          "game": "hytale",
          "targets": [
            "mods"
          ],
          "curseforge": {
            "gameSlug": "hytale",
            "classSlugs": {
              "mods": "mods"
            }
          }
        }
      ],
      "paths": {
        "mods": "/mods"
      }
    }
  }
}
