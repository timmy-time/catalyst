{
  "id": "minecraft-paper",
  "name": "Minecraft Server (Paper)",
  "description": "High-performance Minecraft server running Paper",
  "author": "Catalyst Maintainers",
  "version": "1.20.4",
  "image": "eclipse-temurin:21-jre",
  "installImage": "alpine:3.19",
  "startup": "java -Xms{{MEMORY_XMS}}M -Xmx{{MEMORY}}M -XX:MaxMetaspaceSize=512M -XX:+UnlockExperimentalVMOptions -XX:+UseShenandoahGC -XX:ShenandoahGCHeuristics=compact -XX:ShenandoahUncommitDelay=30000 -XX:ShenandoahAllocationThreshold=15 -XX:ShenandoahGuaranteedGCInterval=30000 -XX:+PerfDisableSharedMem -XX:+DisableExplicitGC -XX:+ParallelRefProcEnabled -XX:ParallelGCThreads=4 -XX:ConcGCThreads=2 -jar paper.jar nogui",
  "stopCommand": "stop",
  "sendSignalTo": "SIGTERM",
  "variables": [
    {
      "name": "MEMORY",
      "description": "Amount of RAM in MB to allocate to the server",
      "default": "1024",
      "required": true,
      "input": "number",
      "rules": ["between:512,16384"]
    },
    {
      "name": "MEMORY_PERCENT",
      "description": "Percent of allocated memory to give the JVM",
      "default": "75",
      "required": false,
      "input": "number",
      "rules": ["between:50,95"]
    },
    {
      "name": "MEMORY_XMS_PERCENT",
      "description": "Percent of JVM max heap to use for Xms",
      "default": "50",
      "required": false,
      "input": "number",
      "rules": ["between:25,90"]
    },
    {
      "name": "PORT",
      "description": "Server port (both container and host will use this port)",
      "default": "25565",
      "required": true,
      "input": "number",
      "rules": ["between:1024,65535"]
    },
    {
      "name": "EULA",
      "description": "Agree to Minecraft EULA",
      "default": "true",
      "required": true,
      "input": "checkbox"
    },
    {
      "name": "DIFFICULTY",
      "description": "Game difficulty level",
      "default": "2",
      "required": false,
      "input": "select",
      "rules": ["in:0,1,2,3"]
    },
    {
      "name": "GAMEMODE",
      "description": "Game mode",
      "default": "survival",
      "required": false,
      "input": "select",
      "rules": ["in:survival,creative,adventure,spectator"]
    },
    {
      "name": "PVP",
      "description": "Enable PvP",
      "default": "true",
      "required": false,
      "input": "checkbox"
    },
    {
      "name": "LEVEL_NAME",
      "description": "World name",
      "default": "world",
      "required": false,
      "input": "text"
    },
    {
      "name": "LEVEL_SEED",
      "description": "World seed (empty for random)",
      "default": "",
      "required": false,
      "input": "text"
    },
    {
      "name": "LEVEL_TYPE",
      "description": "World type",
      "default": "minecraft:normal",
      "required": false,
      "input": "select",
      "rules": ["in:minecraft:normal,minecraft:flat,minecraft:large_biomes,minecraft:amplified"]
    },
    {
      "name": "ONLINE_MODE",
      "description": "Online mode (authentication)",
      "default": "true",
      "required": false,
      "input": "checkbox"
    },
    {
      "name": "WHITE_LIST",
      "description": "Enable whitelist",
      "default": "false",
      "required": false,
      "input": "checkbox"
    },
    {
      "name": "MAX_PLAYERS",
      "description": "Maximum number of players",
      "default": "20",
      "required": false,
      "input": "number",
      "rules": ["between:1,255"]
    },
    {
      "name": "MOTD",
      "description": "Message of the day",
      "default": "A Minecraft Server",
      "required": false,
      "input": "text"
    },
    {
      "name": "ENABLE_RCON",
      "description": "Enable RCON remote console",
      "default": "false",
      "required": false,
      "input": "checkbox"
    }
  ],
  "installScript": "#!/bin/sh\nset -e\n\necho '[Catalyst] Starting Minecraft Paper server installation...'\n\n# Create server directory\nmkdir -p {{SERVER_DIR}}\ncd {{SERVER_DIR}}\n\n# Download Paper server jar (1.20.4 build 499)\necho '[Catalyst] Downloading Paper 1.20.4...'\nif command -v wget >/dev/null 2>&1; then\n  wget -q -O paper.jar https://api.papermc.io/v2/projects/paper/versions/1.20.4/builds/499/downloads/paper-1.20.4-499.jar\nelif command -v curl >/dev/null 2>&1; then\n  curl -sL -o paper.jar https://api.papermc.io/v2/projects/paper/versions/1.20.4/builds/499/downloads/paper-1.20.4-499.jar\nelse\n  echo '[Catalyst] ERROR: Neither wget nor curl found!'\n  exit 1\nfi\n\n# Verify download\nif [ ! -f paper.jar ]; then\n  echo '[Catalyst] ERROR: Failed to download paper.jar'\n  exit 1\nfi\n\necho '[Catalyst] Downloaded paper.jar successfully'\n\n# Accept EULA\necho '[Catalyst] Accepting Minecraft EULA...'\necho 'eula=true' > eula.txt\n\n# Create server.properties with basic settings\ncat > server.properties << 'PROPS'\nserver-port={{PORT}}\ndifficulty={{DIFFICULTY}}\ngamemode={{GAMEMODE}}\npvp={{PVP}}\nlevel-name={{LEVEL_NAME}}\nlevel-seed={{LEVEL_SEED}}\nlevel-type={{LEVEL_TYPE}}\nonline-mode={{ONLINE_MODE}}\nwhite-list={{WHITE_LIST}}\nmax-players={{MAX_PLAYERS}}\nmotd={{MOTD}}\nenable-rcon={{ENABLE_RCON}}\nPROPS\n\necho '[Catalyst] Server configuration created'\necho '[Catalyst] Installation complete!'\n",
  "supportedPorts": [25565],
  "allocatedMemoryMb": 1024,
  "allocatedCpuCores": 2,
  "features": {
    "restartOnExit": true,
    "maxInstances": 10
  }
}
