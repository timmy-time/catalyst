{
  "id": "minecraft-forge",
  "name": "Minecraft Server (Forge)",
  "description": "Forge server (downloaded via MCJARS latest build)",
  "author": "Catalyst Maintainers",
  "version": "1.0.0",
  "image": "eclipse-temurin:21-jre",
  "installImage": "alpine:3.19",
  "startup": "java -Xms{{MEMORY_XMS}}M -Xmx{{MEMORY}}M -jar server.jar nogui",
  "stopCommand": "stop",
  "sendSignalTo": "SIGTERM",
  "variables": [
    {
      "name": "MC_VERSION",
      "description": "Minecraft version (choose version)",
      "default": "1.20.4",
      "required": true,
      "input": "text"
    },
    {
      "name": "PROJECT",
      "description": "MCJARS project identifier",
      "default": "forge",
      "required": true,
      "input": "text"
    },
    {
      "name": "DOWNLOAD_URL",
      "description": "Optional direct download URL (overrides MCJARS API)",
      "default": "",
      "required": false,
      "input": "text"
    },
    {
      "name": "MEMORY",
      "description": "Amount of RAM in MB to allocate to the server",
      "default": "2048",
      "required": true,
      "input": "number",
      "rules": ["between:512,65536"]
    },
    {
      "name": "MEMORY_PERCENT",
      "description": "Percent of allocated memory to give the JVM",
      "default": "75",
      "required": false,
      "input": "number",
      "rules": ["between:50,95"]
    },
    {
      "name": "MEMORY_XMS",
      "description": "Xms in MB (overrides percent) - leave blank to use percent",
      "default": "",
      "required": false,
      "input": "number"
    },
    {
      "name": "PORT",
      "description": "Server port (container & host)",
      "default": "25565",
      "required": true,
      "input": "number",
      "rules": ["between:1024,65535"]
    },
    {
      "name": "EULA",
      "description": "Agree to Minecraft EULA",
      "default": "true",
      "required": true,
      "input": "checkbox"
    }
  ],
  "installScript": "#!/bin/sh\nset -e\n\necho '[Catalyst] Starting installation...'\nmkdir -p {{SERVER_DIR}}\ncd {{SERVER_DIR}}\n\nPROJECT={{PROJECT}}\nMC_VERSION={{MC_VERSION}}\nif [ -n \"{{DOWNLOAD_URL}}\" ] && [ \"{{DOWNLOAD_URL}}\" != \"\" ]; then\n  URL=\"{{DOWNLOAD_URL}}\"\nelse\n  URL1=\"https://mcjars.org/api/v1/projects/${PROJECT}/versions/${MC_VERSION}/builds/latest/download\"\n  URL2=\"https://api.mcjars.org/projects/${PROJECT}/versions/${MC_VERSION}/builds/latest/download\"\n  URL=\"$URL1\"\nfi\n\necho '[Catalyst] Downloading server jar from:' $URL\nif command -v wget >/dev/null 2>&1; then\n  wget -q -O server.jar \"$URL\" || ( [ -n \"$URL2\" ] && wget -q -O server.jar \"$URL2\" )\nelse\n  curl -sL -o server.jar \"$URL\" || ( [ -n \"$URL2\" ] && curl -sL -o server.jar \"$URL2\" )\nfi\n\nif [ ! -f server.jar ]; then\n  echo '[Catalyst] ERROR: Failed to download server.jar. Set DOWNLOAD_URL to a direct download.'\n  exit 1\nfi\n\necho '[Catalyst] Download complete'\n\n# Accept EULA\necho 'eula=true' > eula.txt\n\n# Basic server.properties\ncat > server.properties << 'PROPS'\nserver-port={{PORT}}\nPROPS\n\necho '[Catalyst] Installation complete'\n",
  "supportedPorts": [25565],
  "allocatedMemoryMb": 2048,
  "allocatedCpuCores": 2,
  "features": {
    "restartOnExit": true,
    "modManager": {
      "providers": ["curseforge", "modrinth"],
      "paths": {
        "mods": "/mods",
        "datapacks": "/world/datapacks",
        "modpacks": "/modpacks"
      }
    }
  }
}
