// ============================================================================
// BETTER-AUTH REQUIRED MODELS
// ============================================================================
// These 3 new models are REQUIRED for better-auth integration

// Session Model - Stores user session tokens
model session {
  id        String    @id @default(cuid())
  expiresAt DateTime
  token     String    @unique
  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt
  ipAddress String?   // Optional: track IP for security
  userAgent String?   // Optional: track user agent for security
  
  userId    String
  user      user      @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@index([token])
}

// Account Model - Stores OAuth provider accounts and local auth credentials
model account {
  id                     String    @id @default(cuid())
  accountId              String    // Provider's account ID
  providerId             String    // OAuth provider: "email", "github", "google", etc.
  
  userId                 String
  user                   user      @relation(fields: [userId], references: [id], onDelete: Cascade)
  
  // OAuth tokens (optional, for OAuth flows)
  accessToken            String?   @db.Text
  refreshToken           String?   @db.Text
  idToken                String?   @db.Text
  accessTokenExpiresAt   DateTime?
  refreshTokenExpiresAt  DateTime?
  scope                  String?
  
  // Password hash (for email/password authentication)
  password               String?   // bcrypt hash
  
  createdAt              DateTime  @default(now())
  updatedAt              DateTime  @updatedAt

  @@unique([providerId, accountId])
  @@index([userId])
}

// Verification Model - Handles email verification codes, password reset tokens
model verification {
  id         String    @id @default(cuid())
  identifier String    // What's being verified (email, phone, etc.)
  value      String    @db.Text // The code or token
  expiresAt  DateTime  // When this verification expires
  createdAt  DateTime  @default(now())
  updatedAt  DateTime  @updatedAt

  @@index([identifier])
  @@index([expiresAt])
}

// ============================================================================
// MODIFIED USER MODEL
// ============================================================================
// The existing User model should be updated to include:
// - emailVerified: Boolean @default(false)  [NEW]
// - image: String?                          [NEW]
// - accounts: account[] relationship         [NEW]
// - sessions: session[] relationship         [NEW]
//
// Keep existing fields and relationships:
// - All role, server, and permission relationships
// - All audit log and alert relationships
